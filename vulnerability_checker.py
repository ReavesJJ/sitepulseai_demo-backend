from fastapi import APIRouter
from pydantic import BaseModel



router = APIRouter()

# After defining vuln_router as an APIRouter instance and your routeâ€¦


class VulnerabilityRequest(BaseModel):
    url: str

@router.get("/vulnerabilities")
def scan_vulnerabilities(payload: VulnerabilityRequest):
    url = payload.url

    # Hardcoded test data
    return {
        "url": url,
        "scan_status": "complete",
        "vulnerabilities_found": True,
        "vulnerabilities": [
            {
                "type": "Information Disclosure",
                "detail": "X-Powered-By header is exposed",
                "severity": "Low",
                "recommendation": "Remove or obfuscate the X-Powered-By header."
            },
            {
                "type": "Admin Panel Exposed",
                "detail": "Admin login page found at /admin",
                "severity": "High",
                "recommendation": "Restrict access or add authentication to /admin."
            },
            {
                "type": "Missing Security Headers",
                "detail": "X-Content-Type-Options not set",
                "severity": "Medium",
                "recommendation": "Add X-Content-Type-Options: nosniff to your HTTP headers."
            }
        ]
    }
